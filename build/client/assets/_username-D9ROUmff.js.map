{"version":3,"file":"_username-D9ROUmff.js","sources":["../../../app/routes/$username.tsx"],"sourcesContent":["import { useLoaderData } from 'react-router';\nimport { getUserByUsername } from '~/models/user/user.model';\nimport { getTweetsByUserId } from '~/models/tweet/tweet.model';\nimport { getLikeCount, isLikedByUser } from '~/models/like/like.model';\nimport { getUserId } from '~/lib/auth/session';\nimport { TweetFeed } from '~/components/tweet/TweetFeed';\nimport { formatDistanceToNow } from 'date-fns';\nimport type { Route } from './+types/$username';\n\nexport async function loader({ params, request }: Route.LoaderArgs) {\n  const username = params.username;\n\n  // Get profile\n  const profile = await getUserByUsername(username);\n\n  if (!profile) {\n    throw new Response('User not found', { status: 404 });\n  }\n\n  // Get current user ID (optional)\n  const currentUserId = await getUserId(request).catch(() => null);\n\n  // Get user's tweets\n  const tweets = await getTweetsByUserId(profile.id, 20, 0);\n\n  // Enrich tweets with like information\n  const enrichedTweets = await Promise.all(\n    tweets.map(async (tweet) => {\n      const likeCount = await getLikeCount(tweet.id);\n      const isLiked = currentUserId ? await isLikedByUser(tweet.id, currentUserId) : false;\n      return {\n        ...tweet,\n        likeCount,\n        isLiked,\n      };\n    })\n  );\n\n  const isOwnProfile = currentUserId === profile.id;\n\n  return {\n    profile,\n    tweets: enrichedTweets,\n    isOwnProfile,\n    currentUserId,\n  };\n}\n\nexport default function UserProfilePage() {\n  const { profile, tweets, isOwnProfile, currentUserId } = useLoaderData<typeof loader>();\n\n  const formatJoinDate = (date: Date | string) => {\n    const dateObj = new Date(date);\n    return dateObj.toLocaleDateString('en-US', {\n      month: 'long',\n      year: 'numeric',\n    });\n  };\n\n  return (\n    <div className=\"max-w-2xl mx-auto\">\n      {/* Profile Header */}\n      <div className=\"bg-white rounded-lg shadow-sm p-6 mb-6\">\n        <div className=\"flex items-start space-x-4\">\n          {/* Avatar */}\n          <div>\n            {profile.avatarUrl ? (\n              <img\n                src={profile.avatarUrl}\n                alt={profile.username}\n                className=\"w-24 h-24 rounded-full\"\n              />\n            ) : (\n              <div className=\"w-24 h-24 rounded-full bg-blue-600 flex items-center justify-center text-white font-semibold text-3xl\">\n                {profile.username.charAt(0).toUpperCase()}\n              </div>\n            )}\n          </div>\n\n          {/* Profile Info */}\n          <div className=\"flex-1\">\n            <div className=\"flex items-center justify-between mb-2\">\n              <h1 className=\"text-2xl font-bold text-gray-900\">{profile.username}</h1>\n              {isOwnProfile && (\n                <a\n                  href=\"/settings\"\n                  className=\"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 font-medium text-sm\"\n                >\n                  Edit Profile\n                </a>\n              )}\n            </div>\n\n            {profile.bio && (\n              <p className=\"text-gray-700 mb-3 whitespace-pre-wrap\">{profile.bio}</p>\n            )}\n\n            <p className=\"text-gray-500 text-sm\">\n              Joined {formatJoinDate(profile.createdAt)}\n            </p>\n          </div>\n        </div>\n      </div>\n\n      {/* Tweets Section */}\n      <div className=\"mb-4\">\n        <h2 className=\"text-xl font-semibold text-gray-900 mb-4\">\n          Tweets ({tweets.length})\n        </h2>\n\n        <TweetFeed\n          tweets={tweets}\n          currentUserId={currentUserId ?? undefined}\n          showLoadMore={false}\n        />\n      </div>\n    </div>\n  );\n}\n"],"names":["$username","_UNSAFE_withComponentProps","profile","tweets","isOwnProfile","currentUserId","useLoaderData","formatJoinDate","date","Date","toLocaleDateString","month","year","jsxs","className","children","jsx","avatarUrl","src","alt","username","charAt","toUpperCase","href","bio","createdAt","length","TweetFeed","showLoadMore"],"mappings":"2GAgDA,MAAAA,EAAAC,EAAA,UAA0C,CACxC,KAAM,CAAEC,QAAAA,EAASC,OAAAA,EAAQC,aAAAA,EAAcC,cAAAA,GAAkBC,EAAA,EAEnDC,EAAkBC,GACN,IAAIC,KAAKD,CAAI,EACdE,mBAAmB,QAAS,CACzCC,MAAO,OACPC,KAAM,SACR,CAAC,EAGH,OACEC,EAAAA,KAAC,MAAA,CAAIC,UAAU,oBAEbC,SAAA,CAAAC,EAAAA,IAAC,OAAIF,UAAU,yCACbC,SAAAF,EAAAA,KAAC,MAAA,CAAIC,UAAU,6BAEbC,SAAA,CAAAC,EAAAA,IAAC,MAAA,CACED,WAAQE,UACPD,EAAAA,IAAC,MAAA,CACCE,IAAKhB,EAAQe,UACbE,IAAKjB,EAAQkB,SACbN,UAAU,wBAAA,CACZ,EAEAE,EAAAA,IAAC,MAAA,CAAIF,UAAU,wGACZC,SAAAb,EAAQkB,SAASC,OAAO,CAAC,EAAEC,YAAA,EAC9B,CAAA,CAEJ,EAGAT,EAAAA,KAAC,MAAA,CAAIC,UAAU,SACbC,SAAA,CAAAF,EAAAA,KAAC,MAAA,CAAIC,UAAU,yCACbC,SAAA,CAAAC,EAAAA,IAAC,KAAA,CAAGF,UAAU,mCAAoCC,SAAAb,EAAQkB,SAAS,EAClEhB,GACCY,EAAAA,IAAC,IAAA,CACCO,KAAK,YACLT,UAAU,oFACXC,SAAA,cAAA,CAED,CAAA,EAEJ,EAECb,EAAQsB,KACPR,EAAAA,IAAC,KAAEF,UAAU,yCAA0CC,WAAQS,GAAA,CAAI,EAGrEX,EAAAA,KAAC,IAAA,CAAEC,UAAU,wBAAwBC,SAAA,CAAA,UAC3BR,EAAeL,EAAQuB,SAAS,CAAA,CAAA,CAC1C,CAAA,CAAA,CACF,CAAA,EACF,CAAA,CACF,EAGAZ,EAAAA,KAAC,MAAA,CAAIC,UAAU,OACbC,SAAA,CAAAF,EAAAA,KAAC,KAAA,CAAGC,UAAU,2CAA2CC,SAAA,CAAA,WAC9CZ,EAAOuB,OAAO,GAAA,CAAA,CACzB,EAEAV,EAAAA,IAACW,EAAA,CACCxB,OAAAA,EACAE,cAAeA,GAAiB,OAChCuB,aAAc,EAAA,CAChB,CAAA,CAAA,CACF,CAAA,CAAA,CACF,CAEJ,CAAA"}