{"version":3,"file":"login-B-7OPwSV.js","sources":["../../../app/routes/login.tsx"],"sourcesContent":["import { Form, useActionData, useNavigation, useSearchParams } from 'react-router';\nimport { authenticateUser } from '~/models/auth/auth.model';\nimport { createUserSession } from '~/lib/auth/session';\nimport { loginRateLimiter, getClientIp } from '~/lib/security/rate-limit';\nimport type { Route } from './+types/login';\n\nexport async function action({ request }: Route.ActionArgs) {\n  const formData = await request.formData();\n  const email = formData.get('email') as string;\n  const password = formData.get('password') as string;\n  const redirectTo = (formData.get('redirectTo') as string) || '/home';\n\n  try {\n    // Rate limiting\n    const clientIp = getClientIp(request);\n    const rateLimit = await loginRateLimiter(clientIp);\n\n    if (!rateLimit.allowed) {\n      return { error: 'Too many login attempts. Please try again later.' };\n    }\n\n    // Authenticate user\n    const user = await authenticateUser(email, password);\n\n    if (!user) {\n      return { error: 'Invalid email or password' };\n    }\n\n    // Create session and redirect\n    return await createUserSession(user.id, redirectTo);\n  } catch (error) {\n    if (error instanceof Error) {\n      return { error: error.message };\n    }\n    return { error: 'Failed to login' };\n  }\n}\n\nexport default function LoginPage() {\n  const actionData = useActionData<typeof action>();\n  const navigation = useNavigation();\n  const [searchParams] = useSearchParams();\n  const isSubmitting = navigation.state === 'submitting';\n\n  const verificationPending = searchParams.get('verified') === 'pending';\n  const redirectTo = searchParams.get('redirectTo') || '/home';\n\n  return (\n    <div className=\"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8\">\n      <div className=\"max-w-md w-full space-y-8\">\n        <div>\n          <h1 className=\"text-center text-3xl font-extrabold text-gray-900\">\n            Log in to Tweeter\n          </h1>\n          <p className=\"mt-2 text-center text-sm text-gray-600\">\n            Welcome back!\n          </p>\n        </div>\n\n        {verificationPending && (\n          <div className=\"bg-blue-50 border border-blue-200 text-blue-800 px-4 py-3 rounded\">\n            Please check your email and click the verification link to activate your account.\n          </div>\n        )}\n\n        <Form method=\"post\" className=\"mt-8 space-y-6\">\n          <input type=\"hidden\" name=\"redirectTo\" value={redirectTo} />\n\n          {actionData?.error && (\n            <div className=\"bg-red-50 border border-red-200 text-red-800 px-4 py-3 rounded\">\n              {actionData.error}\n            </div>\n          )}\n\n          <div className=\"space-y-4\">\n            <div>\n              <label htmlFor=\"email\" className=\"block text-sm font-medium text-gray-700\">\n                Email address\n              </label>\n              <input\n                id=\"email\"\n                name=\"email\"\n                type=\"email\"\n                required\n                autoComplete=\"email\"\n                className=\"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500\"\n                placeholder=\"you@example.com\"\n              />\n            </div>\n\n            <div>\n              <label htmlFor=\"password\" className=\"block text-sm font-medium text-gray-700\">\n                Password\n              </label>\n              <input\n                id=\"password\"\n                name=\"password\"\n                type=\"password\"\n                required\n                autoComplete=\"current-password\"\n                className=\"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500\"\n                placeholder=\"••••••••\"\n              />\n            </div>\n          </div>\n\n          <button\n            type=\"submit\"\n            disabled={isSubmitting}\n            className=\"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed\"\n          >\n            {isSubmitting ? 'Logging in...' : 'Log in'}\n          </button>\n\n          <p className=\"text-center text-sm text-gray-600\">\n            Don't have an account?{' '}\n            <a href=\"/signup\" className=\"font-medium text-blue-600 hover:text-blue-500\">\n              Sign up\n            </a>\n          </p>\n        </Form>\n      </div>\n    </div>\n  );\n}\n"],"names":["login","_UNSAFE_withComponentProps","actionData","useActionData","navigation","useNavigation","searchParams","useSearchParams","isSubmitting","state","verificationPending","get","redirectTo","className","children","jsxs","jsx","Form","method","type","name","value","error","htmlFor","id","required","autoComplete","placeholder","disabled","href"],"mappings":"oFAsCA,MAAAA,EAAAC,EAAA,UAAoC,CAClC,MAAMC,EAAaC,EAAA,EACbC,EAAaC,EAAA,EACb,CAACC,CAAY,EAAIC,EAAA,EACjBC,EAAeJ,EAAWK,QAAU,aAEpCC,EAAsBJ,EAAaK,IAAI,UAAU,IAAM,UACvDC,EAAaN,EAAaK,IAAI,YAAY,GAAK,QAErD,aACG,MAAA,CAAIE,UAAU,sFACbC,SAAAC,EAAAA,KAAC,MAAA,CAAIF,UAAU,4BACbC,SAAA,CAAAC,EAAAA,KAAC,MAAA,CACCD,SAAA,CAAAE,EAAAA,IAAC,KAAA,CAAGH,UAAU,oDAAoDC,SAAA,mBAAA,CAElE,EACAE,EAAAA,IAAC,IAAA,CAAEH,UAAU,yCAAyCC,SAAA,eAAA,CAEtD,CAAA,EACF,EAECJ,GACCM,EAAAA,IAAC,MAAA,CAAIH,UAAU,oEAAoEC,SAAA,mFAAA,CAEnF,EAGFC,EAAAA,KAACE,EAAA,CAAKC,OAAO,OAAOL,UAAU,iBAC5BC,SAAA,CAAAE,EAAAA,IAAC,SAAMG,KAAK,SAASC,KAAK,aAAaC,MAAOT,EAAY,EAEzDV,GAAYoB,OACXN,EAAAA,IAAC,OAAIH,UAAU,iEACZC,WAAWQ,KAAA,CACd,EAGFP,EAAAA,KAAC,MAAA,CAAIF,UAAU,YACbC,SAAA,CAAAC,EAAAA,KAAC,MAAA,CACCD,SAAA,CAAAE,EAAAA,IAAC,QAAA,CAAMO,QAAQ,QAAQV,UAAU,0CAA0CC,SAAA,eAAA,CAE3E,EACAE,EAAAA,IAAC,QAAA,CACCQ,GAAG,QACHJ,KAAK,QACLD,KAAK,QACLM,SAAQ,GACRC,aAAa,QACbb,UAAU,uIACVc,YAAY,iBAAA,CACd,CAAA,CAAA,CACF,SAEC,MAAA,CACCb,SAAA,CAAAE,EAAAA,IAAC,QAAA,CAAMO,QAAQ,WAAWV,UAAU,0CAA0CC,SAAA,UAAA,CAE9E,EACAE,EAAAA,IAAC,QAAA,CACCQ,GAAG,WACHJ,KAAK,WACLD,KAAK,WACLM,SAAQ,GACRC,aAAa,mBACbb,UAAU,uIACVc,YAAY,UAAA,CACd,CAAA,CAAA,CACF,CAAA,CAAA,CACF,EAEAX,EAAAA,IAAC,SAAA,CACCG,KAAK,SACLS,SAAUpB,EACVK,UAAU,2QAETC,WAAe,gBAAkB,QAAA,CACpC,EAEAC,EAAAA,KAAC,IAAA,CAAEF,UAAU,oCAAoCC,SAAA,CAAA,yBACxB,UACtB,IAAA,CAAEe,KAAK,UAAUhB,UAAU,gDAAgDC,SAAA,SAAA,CAE5E,CAAA,CAAA,CACF,CAAA,CAAA,CACF,CAAA,EACF,CAAA,CACF,CAEJ,CAAA"}